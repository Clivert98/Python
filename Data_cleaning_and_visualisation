{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "7b2c59da",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:05.857546Z",
     "iopub.status.busy": "2024-08-23T13:44:05.857040Z",
     "iopub.status.idle": "2024-08-23T13:44:06.328007Z",
     "shell.execute_reply": "2024-08-23T13:44:06.326656Z"
    },
    "papermill": {
     "duration": 0.493357,
     "end_time": "2024-08-23T13:44:06.331588",
     "exception": false,
     "start_time": "2024-08-23T13:44:05.838231",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/sales-data/sales_data_sample.csv\n"
     ]
    }
   ],
   "source": [
    "# This Python 3 environment comes with many helpful analytics libraries installed\n",
    "# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n",
    "# For example, here's several helpful packages to load\n",
    "\n",
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "\n",
    "# Input data files are available in the read-only \"../input/\" directory\n",
    "# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n",
    "\n",
    "import os\n",
    "for dirname, _, filenames in os.walk('/kaggle/input'):\n",
    "    for filename in filenames:\n",
    "        print(os.path.join(dirname, filename))\n",
    "\n",
    "# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n",
    "# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4dea4c9e",
   "metadata": {
    "papermill": {
     "duration": 0.01176,
     "end_time": "2024-08-23T13:44:06.356056",
     "exception": false,
     "start_time": "2024-08-23T13:44:06.344296",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "- What are the total sales over the past year?\n",
    "- Which product has the highest sales?\n",
    "- What is the average order value?\n",
    "- How many unique customers made purchases?\n",
    "- What is the sales trend over the past year?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "2bb69f67",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:06.382992Z",
     "iopub.status.busy": "2024-08-23T13:44:06.382424Z",
     "iopub.status.idle": "2024-08-23T13:44:08.534128Z",
     "shell.execute_reply": "2024-08-23T13:44:08.532926Z"
    },
    "papermill": {
     "duration": 2.168883,
     "end_time": "2024-08-23T13:44:08.537063",
     "exception": false,
     "start_time": "2024-08-23T13:44:06.368180",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# First import libraries\n",
    "\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import numpy as np"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "593be76e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:08.564086Z",
     "iopub.status.busy": "2024-08-23T13:44:08.563503Z",
     "iopub.status.idle": "2024-08-23T13:44:08.662725Z",
     "shell.execute_reply": "2024-08-23T13:44:08.661518Z"
    },
    "papermill": {
     "duration": 0.115929,
     "end_time": "2024-08-23T13:44:08.665511",
     "exception": false,
     "start_time": "2024-08-23T13:44:08.549582",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ORDERNUMBER</th>\n",
       "      <th>QUANTITYORDERED</th>\n",
       "      <th>PRICEEACH</th>\n",
       "      <th>ORDERLINENUMBER</th>\n",
       "      <th>SALES</th>\n",
       "      <th>ORDERDATE</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>QTR_ID</th>\n",
       "      <th>MONTH_ID</th>\n",
       "      <th>YEAR_ID</th>\n",
       "      <th>...</th>\n",
       "      <th>ADDRESSLINE1</th>\n",
       "      <th>ADDRESSLINE2</th>\n",
       "      <th>CITY</th>\n",
       "      <th>STATE</th>\n",
       "      <th>POSTALCODE</th>\n",
       "      <th>COUNTRY</th>\n",
       "      <th>TERRITORY</th>\n",
       "      <th>CONTACTLASTNAME</th>\n",
       "      <th>CONTACTFIRSTNAME</th>\n",
       "      <th>DEALSIZE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10107</td>\n",
       "      <td>30</td>\n",
       "      <td>95.70</td>\n",
       "      <td>2</td>\n",
       "      <td>2871.00</td>\n",
       "      <td>2/24/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>897 Long Airport Avenue</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NYC</td>\n",
       "      <td>NY</td>\n",
       "      <td>10022</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Yu</td>\n",
       "      <td>Kwai</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10121</td>\n",
       "      <td>34</td>\n",
       "      <td>81.35</td>\n",
       "      <td>5</td>\n",
       "      <td>2765.90</td>\n",
       "      <td>5/7/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>10134</td>\n",
       "      <td>41</td>\n",
       "      <td>94.74</td>\n",
       "      <td>2</td>\n",
       "      <td>3884.34</td>\n",
       "      <td>7/1/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>27 rue du Colonel Pierre Avia</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Paris</td>\n",
       "      <td>NaN</td>\n",
       "      <td>75508</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Da Cunha</td>\n",
       "      <td>Daniel</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>10145</td>\n",
       "      <td>45</td>\n",
       "      <td>83.26</td>\n",
       "      <td>6</td>\n",
       "      <td>3746.70</td>\n",
       "      <td>8/25/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>3</td>\n",
       "      <td>8</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>78934 Hillside Dr.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Pasadena</td>\n",
       "      <td>CA</td>\n",
       "      <td>90003</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Young</td>\n",
       "      <td>Julie</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>10159</td>\n",
       "      <td>49</td>\n",
       "      <td>100.00</td>\n",
       "      <td>14</td>\n",
       "      <td>5205.27</td>\n",
       "      <td>10/10/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>10</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>7734 Strong St.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>San Francisco</td>\n",
       "      <td>CA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Brown</td>\n",
       "      <td>Julie</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2818</th>\n",
       "      <td>10350</td>\n",
       "      <td>20</td>\n",
       "      <td>100.00</td>\n",
       "      <td>15</td>\n",
       "      <td>2244.40</td>\n",
       "      <td>12/2/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>12</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>C/ Moralzarzal, 86</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>NaN</td>\n",
       "      <td>28034</td>\n",
       "      <td>Spain</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Freyre</td>\n",
       "      <td>Diego</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2819</th>\n",
       "      <td>10373</td>\n",
       "      <td>29</td>\n",
       "      <td>100.00</td>\n",
       "      <td>1</td>\n",
       "      <td>3978.51</td>\n",
       "      <td>1/31/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>Torikatu 38</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Oulu</td>\n",
       "      <td>NaN</td>\n",
       "      <td>90110</td>\n",
       "      <td>Finland</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Koskitalo</td>\n",
       "      <td>Pirkko</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2820</th>\n",
       "      <td>10386</td>\n",
       "      <td>43</td>\n",
       "      <td>100.00</td>\n",
       "      <td>4</td>\n",
       "      <td>5417.57</td>\n",
       "      <td>3/1/2005 0:00</td>\n",
       "      <td>Resolved</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>C/ Moralzarzal, 86</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Madrid</td>\n",
       "      <td>NaN</td>\n",
       "      <td>28034</td>\n",
       "      <td>Spain</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Freyre</td>\n",
       "      <td>Diego</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2821</th>\n",
       "      <td>10397</td>\n",
       "      <td>34</td>\n",
       "      <td>62.24</td>\n",
       "      <td>1</td>\n",
       "      <td>2116.16</td>\n",
       "      <td>3/28/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>1 rue Alsace-Lorraine</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Toulouse</td>\n",
       "      <td>NaN</td>\n",
       "      <td>31000</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Roulet</td>\n",
       "      <td>Annette</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2822</th>\n",
       "      <td>10414</td>\n",
       "      <td>47</td>\n",
       "      <td>65.52</td>\n",
       "      <td>9</td>\n",
       "      <td>3079.44</td>\n",
       "      <td>5/6/2005 0:00</td>\n",
       "      <td>On Hold</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>8616 Spinnaker Dr.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Boston</td>\n",
       "      <td>MA</td>\n",
       "      <td>51003</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Yoshido</td>\n",
       "      <td>Juri</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2823 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      ORDERNUMBER  QUANTITYORDERED  PRICEEACH  ORDERLINENUMBER    SALES  \\\n",
       "0           10107               30      95.70                2  2871.00   \n",
       "1           10121               34      81.35                5  2765.90   \n",
       "2           10134               41      94.74                2  3884.34   \n",
       "3           10145               45      83.26                6  3746.70   \n",
       "4           10159               49     100.00               14  5205.27   \n",
       "...           ...              ...        ...              ...      ...   \n",
       "2818        10350               20     100.00               15  2244.40   \n",
       "2819        10373               29     100.00                1  3978.51   \n",
       "2820        10386               43     100.00                4  5417.57   \n",
       "2821        10397               34      62.24                1  2116.16   \n",
       "2822        10414               47      65.52                9  3079.44   \n",
       "\n",
       "            ORDERDATE    STATUS  QTR_ID  MONTH_ID  YEAR_ID  ...  \\\n",
       "0      2/24/2003 0:00   Shipped       1         2     2003  ...   \n",
       "1       5/7/2003 0:00   Shipped       2         5     2003  ...   \n",
       "2       7/1/2003 0:00   Shipped       3         7     2003  ...   \n",
       "3      8/25/2003 0:00   Shipped       3         8     2003  ...   \n",
       "4     10/10/2003 0:00   Shipped       4        10     2003  ...   \n",
       "...               ...       ...     ...       ...      ...  ...   \n",
       "2818   12/2/2004 0:00   Shipped       4        12     2004  ...   \n",
       "2819   1/31/2005 0:00   Shipped       1         1     2005  ...   \n",
       "2820    3/1/2005 0:00  Resolved       1         3     2005  ...   \n",
       "2821   3/28/2005 0:00   Shipped       1         3     2005  ...   \n",
       "2822    5/6/2005 0:00   On Hold       2         5     2005  ...   \n",
       "\n",
       "                       ADDRESSLINE1  ADDRESSLINE2           CITY STATE  \\\n",
       "0           897 Long Airport Avenue           NaN            NYC    NY   \n",
       "1                59 rue de l'Abbaye           NaN          Reims   NaN   \n",
       "2     27 rue du Colonel Pierre Avia           NaN          Paris   NaN   \n",
       "3                78934 Hillside Dr.           NaN       Pasadena    CA   \n",
       "4                   7734 Strong St.           NaN  San Francisco    CA   \n",
       "...                             ...           ...            ...   ...   \n",
       "2818             C/ Moralzarzal, 86           NaN         Madrid   NaN   \n",
       "2819                    Torikatu 38           NaN           Oulu   NaN   \n",
       "2820             C/ Moralzarzal, 86           NaN         Madrid   NaN   \n",
       "2821          1 rue Alsace-Lorraine           NaN       Toulouse   NaN   \n",
       "2822             8616 Spinnaker Dr.           NaN         Boston    MA   \n",
       "\n",
       "     POSTALCODE  COUNTRY TERRITORY CONTACTLASTNAME CONTACTFIRSTNAME DEALSIZE  \n",
       "0         10022      USA       NaN              Yu             Kwai    Small  \n",
       "1         51100   France      EMEA         Henriot             Paul    Small  \n",
       "2         75508   France      EMEA        Da Cunha           Daniel   Medium  \n",
       "3         90003      USA       NaN           Young            Julie   Medium  \n",
       "4           NaN      USA       NaN           Brown            Julie   Medium  \n",
       "...         ...      ...       ...             ...              ...      ...  \n",
       "2818      28034    Spain      EMEA          Freyre            Diego    Small  \n",
       "2819      90110  Finland      EMEA       Koskitalo           Pirkko   Medium  \n",
       "2820      28034    Spain      EMEA          Freyre            Diego   Medium  \n",
       "2821      31000   France      EMEA          Roulet          Annette    Small  \n",
       "2822      51003      USA       NaN         Yoshido             Juri   Medium  \n",
       "\n",
       "[2823 rows x 25 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Reading dataset file into Python and creating a variable name for the df\n",
    "\n",
    "path = '/kaggle/input/sales-data/sales_data_sample.csv'\n",
    "sales_data = pd.read_csv(path,encoding = 'latin1')\n",
    "sales_data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "4cf82752",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:08.694012Z",
     "iopub.status.busy": "2024-08-23T13:44:08.692726Z",
     "iopub.status.idle": "2024-08-23T13:44:08.729896Z",
     "shell.execute_reply": "2024-08-23T13:44:08.728614Z"
    },
    "papermill": {
     "duration": 0.054002,
     "end_time": "2024-08-23T13:44:08.732429",
     "exception": false,
     "start_time": "2024-08-23T13:44:08.678427",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ORDERNUMBER</th>\n",
       "      <th>QUANTITYORDERED</th>\n",
       "      <th>PRICEEACH</th>\n",
       "      <th>ORDERLINENUMBER</th>\n",
       "      <th>SALES</th>\n",
       "      <th>ORDERDATE</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>QTR_ID</th>\n",
       "      <th>MONTH_ID</th>\n",
       "      <th>YEAR_ID</th>\n",
       "      <th>...</th>\n",
       "      <th>ADDRESSLINE1</th>\n",
       "      <th>ADDRESSLINE2</th>\n",
       "      <th>CITY</th>\n",
       "      <th>STATE</th>\n",
       "      <th>POSTALCODE</th>\n",
       "      <th>COUNTRY</th>\n",
       "      <th>TERRITORY</th>\n",
       "      <th>CONTACTLASTNAME</th>\n",
       "      <th>CONTACTFIRSTNAME</th>\n",
       "      <th>DEALSIZE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2818</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2819</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2820</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2821</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2822</th>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2823 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      ORDERNUMBER  QUANTITYORDERED  PRICEEACH  ORDERLINENUMBER  SALES  \\\n",
       "0           False            False      False            False  False   \n",
       "1           False            False      False            False  False   \n",
       "2           False            False      False            False  False   \n",
       "3           False            False      False            False  False   \n",
       "4           False            False      False            False  False   \n",
       "...           ...              ...        ...              ...    ...   \n",
       "2818        False            False      False            False  False   \n",
       "2819        False            False      False            False  False   \n",
       "2820        False            False      False            False  False   \n",
       "2821        False            False      False            False  False   \n",
       "2822        False            False      False            False  False   \n",
       "\n",
       "      ORDERDATE  STATUS  QTR_ID  MONTH_ID  YEAR_ID  ...  ADDRESSLINE1  \\\n",
       "0         False   False   False     False    False  ...         False   \n",
       "1         False   False   False     False    False  ...         False   \n",
       "2         False   False   False     False    False  ...         False   \n",
       "3         False   False   False     False    False  ...         False   \n",
       "4         False   False   False     False    False  ...         False   \n",
       "...         ...     ...     ...       ...      ...  ...           ...   \n",
       "2818      False   False   False     False    False  ...         False   \n",
       "2819      False   False   False     False    False  ...         False   \n",
       "2820      False   False   False     False    False  ...         False   \n",
       "2821      False   False   False     False    False  ...         False   \n",
       "2822      False   False   False     False    False  ...         False   \n",
       "\n",
       "      ADDRESSLINE2   CITY  STATE  POSTALCODE  COUNTRY  TERRITORY  \\\n",
       "0             True  False  False       False    False       True   \n",
       "1             True  False   True       False    False      False   \n",
       "2             True  False   True       False    False      False   \n",
       "3             True  False  False       False    False       True   \n",
       "4             True  False  False        True    False       True   \n",
       "...            ...    ...    ...         ...      ...        ...   \n",
       "2818          True  False   True       False    False      False   \n",
       "2819          True  False   True       False    False      False   \n",
       "2820          True  False   True       False    False      False   \n",
       "2821          True  False   True       False    False      False   \n",
       "2822          True  False  False       False    False       True   \n",
       "\n",
       "      CONTACTLASTNAME  CONTACTFIRSTNAME  DEALSIZE  \n",
       "0               False             False     False  \n",
       "1               False             False     False  \n",
       "2               False             False     False  \n",
       "3               False             False     False  \n",
       "4               False             False     False  \n",
       "...               ...               ...       ...  \n",
       "2818            False             False     False  \n",
       "2819            False             False     False  \n",
       "2820            False             False     False  \n",
       "2821            False             False     False  \n",
       "2822            False             False     False  \n",
       "\n",
       "[2823 rows x 25 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# First we check for missing values\n",
    "\n",
    "sales_data.isna()  "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "823c1424",
   "metadata": {
    "papermill": {
     "duration": 0.013047,
     "end_time": "2024-08-23T13:44:08.758949",
     "exception": false,
     "start_time": "2024-08-23T13:44:08.745902",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "- We can see 'Addressline2' has missing values\n",
    "- 'State' has missing values \n",
    "- 'Territory' has missing values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "02cd81ca",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:08.787327Z",
     "iopub.status.busy": "2024-08-23T13:44:08.786906Z",
     "iopub.status.idle": "2024-08-23T13:44:08.801434Z",
     "shell.execute_reply": "2024-08-23T13:44:08.800256Z"
    },
    "papermill": {
     "duration": 0.03144,
     "end_time": "2024-08-23T13:44:08.803819",
     "exception": false,
     "start_time": "2024-08-23T13:44:08.772379",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ORDERNUMBER            0\n",
       "QUANTITYORDERED        0\n",
       "PRICEEACH              0\n",
       "ORDERLINENUMBER        0\n",
       "SALES                  0\n",
       "ORDERDATE              0\n",
       "STATUS                 0\n",
       "QTR_ID                 0\n",
       "MONTH_ID               0\n",
       "YEAR_ID                0\n",
       "PRODUCTLINE            0\n",
       "MSRP                   0\n",
       "PRODUCTCODE            0\n",
       "CUSTOMERNAME           0\n",
       "PHONE                  0\n",
       "ADDRESSLINE1           0\n",
       "ADDRESSLINE2        2521\n",
       "CITY                   0\n",
       "STATE               1486\n",
       "POSTALCODE            76\n",
       "COUNTRY                0\n",
       "TERRITORY           1074\n",
       "CONTACTLASTNAME        0\n",
       "CONTACTFIRSTNAME       0\n",
       "DEALSIZE               0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# To check how many missing values are in a column\n",
    "\n",
    "sales_data.isna().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "37a0e6e2",
   "metadata": {
    "papermill": {
     "duration": 0.013074,
     "end_time": "2024-08-23T13:44:08.830408",
     "exception": false,
     "start_time": "2024-08-23T13:44:08.817334",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "- From this it has revealed 'ADDRESSLINE2' has 2521 missing values\n",
    "- 'STATE' has 1486 missing values\n",
    "- 'TERRITORY' has 1074 missing values\n",
    "- Postal code 76 "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "424f07d1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:08.859271Z",
     "iopub.status.busy": "2024-08-23T13:44:08.858816Z",
     "iopub.status.idle": "2024-08-23T13:44:08.892766Z",
     "shell.execute_reply": "2024-08-23T13:44:08.891515Z"
    },
    "papermill": {
     "duration": 0.051383,
     "end_time": "2024-08-23T13:44:08.895325",
     "exception": false,
     "start_time": "2024-08-23T13:44:08.843942",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2823"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Now to check the dimensions of the data to see how many rows there are\n",
    "\n",
    "sales_data.describe()  # Can find out by the count\n",
    "len(sales_data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "7bb3acdb",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:08.924644Z",
     "iopub.status.busy": "2024-08-23T13:44:08.924196Z",
     "iopub.status.idle": "2024-08-23T13:44:08.932958Z",
     "shell.execute_reply": "2024-08-23T13:44:08.931571Z"
    },
    "papermill": {
     "duration": 0.026481,
     "end_time": "2024-08-23T13:44:08.935504",
     "exception": false,
     "start_time": "2024-08-23T13:44:08.909023",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "38.04463336875664"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Have to work out if to remove rows or replace them\n",
    "# ADDRESSLINE2\n",
    "2521 / 2823 * 100 \n",
    "\n",
    "#STATE\n",
    "1486 / 2823 * 100\n",
    "\n",
    "# TERRITORY\n",
    "1074 /2823 * 100"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3167db44",
   "metadata": {
    "papermill": {
     "duration": 0.013617,
     "end_time": "2024-08-23T13:44:08.963340",
     "exception": false,
     "start_time": "2024-08-23T13:44:08.949723",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "- ADDRESSLINE2 has to be removed (89.3%)\n",
    "- STATE must be considered with (52.6%)\n",
    "- TERRITORY must be considered also (38%)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "103ffb62",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:08.992982Z",
     "iopub.status.busy": "2024-08-23T13:44:08.992529Z",
     "iopub.status.idle": "2024-08-23T13:44:09.000474Z",
     "shell.execute_reply": "2024-08-23T13:44:08.999316Z"
    },
    "papermill": {
     "duration": 0.025705,
     "end_time": "2024-08-23T13:44:09.003033",
     "exception": false,
     "start_time": "2024-08-23T13:44:08.977328",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([nan, 'EMEA', 'APAC', 'Japan'], dtype=object)"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# To start with the territory column \n",
    "# Need to see all the Unique values in the column\n",
    "\n",
    "sales_data.TERRITORY.unique()   "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "f5eb7321",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.033853Z",
     "iopub.status.busy": "2024-08-23T13:44:09.032694Z",
     "iopub.status.idle": "2024-08-23T13:44:09.043988Z",
     "shell.execute_reply": "2024-08-23T13:44:09.042838Z"
    },
    "papermill": {
     "duration": 0.02923,
     "end_time": "2024-08-23T13:44:09.046555",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.017325",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['USA', 'France', 'Norway', 'Australia', 'Finland', 'Austria', 'UK',\n",
       "       'Spain', 'Sweden', 'Singapore', 'Canada', 'Japan', 'Italy',\n",
       "       'Denmark', 'Belgium', 'Philippines', 'Germany', 'Switzerland',\n",
       "       'Ireland'], dtype=object)"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sales_data.COUNTRY.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "18a65406",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.076757Z",
     "iopub.status.busy": "2024-08-23T13:44:09.076279Z",
     "iopub.status.idle": "2024-08-23T13:44:09.110097Z",
     "shell.execute_reply": "2024-08-23T13:44:09.108879Z"
    },
    "papermill": {
     "duration": 0.052007,
     "end_time": "2024-08-23T13:44:09.112827",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.060820",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ORDERNUMBER</th>\n",
       "      <th>QUANTITYORDERED</th>\n",
       "      <th>PRICEEACH</th>\n",
       "      <th>ORDERLINENUMBER</th>\n",
       "      <th>SALES</th>\n",
       "      <th>ORDERDATE</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>QTR_ID</th>\n",
       "      <th>MONTH_ID</th>\n",
       "      <th>YEAR_ID</th>\n",
       "      <th>...</th>\n",
       "      <th>ADDRESSLINE1</th>\n",
       "      <th>ADDRESSLINE2</th>\n",
       "      <th>CITY</th>\n",
       "      <th>STATE</th>\n",
       "      <th>POSTALCODE</th>\n",
       "      <th>COUNTRY</th>\n",
       "      <th>TERRITORY</th>\n",
       "      <th>CONTACTLASTNAME</th>\n",
       "      <th>CONTACTFIRSTNAME</th>\n",
       "      <th>DEALSIZE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10107</td>\n",
       "      <td>30</td>\n",
       "      <td>95.70</td>\n",
       "      <td>2</td>\n",
       "      <td>2871.00</td>\n",
       "      <td>2/24/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>897 Long Airport Avenue</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NYC</td>\n",
       "      <td>NY</td>\n",
       "      <td>10022</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Yu</td>\n",
       "      <td>Kwai</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>10145</td>\n",
       "      <td>45</td>\n",
       "      <td>83.26</td>\n",
       "      <td>6</td>\n",
       "      <td>3746.70</td>\n",
       "      <td>8/25/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>3</td>\n",
       "      <td>8</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>78934 Hillside Dr.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Pasadena</td>\n",
       "      <td>CA</td>\n",
       "      <td>90003</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Young</td>\n",
       "      <td>Julie</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>10159</td>\n",
       "      <td>49</td>\n",
       "      <td>100.00</td>\n",
       "      <td>14</td>\n",
       "      <td>5205.27</td>\n",
       "      <td>10/10/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>10</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>7734 Strong St.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>San Francisco</td>\n",
       "      <td>CA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Brown</td>\n",
       "      <td>Julie</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>10168</td>\n",
       "      <td>36</td>\n",
       "      <td>96.66</td>\n",
       "      <td>1</td>\n",
       "      <td>3479.76</td>\n",
       "      <td>10/28/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>10</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>9408 Furth Circle</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Burlingame</td>\n",
       "      <td>CA</td>\n",
       "      <td>94217</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hirano</td>\n",
       "      <td>Juri</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>10201</td>\n",
       "      <td>22</td>\n",
       "      <td>98.57</td>\n",
       "      <td>2</td>\n",
       "      <td>2168.54</td>\n",
       "      <td>12/1/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>12</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>5557 North Pendale Street</td>\n",
       "      <td>NaN</td>\n",
       "      <td>San Francisco</td>\n",
       "      <td>CA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Murphy</td>\n",
       "      <td>Julie</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2804</th>\n",
       "      <td>10185</td>\n",
       "      <td>28</td>\n",
       "      <td>64.43</td>\n",
       "      <td>6</td>\n",
       "      <td>1804.04</td>\n",
       "      <td>11/14/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>11</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>4575 Hillside Dr.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>New Bedford</td>\n",
       "      <td>MA</td>\n",
       "      <td>50553</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Tam</td>\n",
       "      <td>Wing C</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2807</th>\n",
       "      <td>10222</td>\n",
       "      <td>36</td>\n",
       "      <td>63.34</td>\n",
       "      <td>18</td>\n",
       "      <td>2280.24</td>\n",
       "      <td>2/19/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>361 Furth Circle</td>\n",
       "      <td>NaN</td>\n",
       "      <td>San Diego</td>\n",
       "      <td>CA</td>\n",
       "      <td>91217</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Thompson</td>\n",
       "      <td>Valarie</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2809</th>\n",
       "      <td>10248</td>\n",
       "      <td>23</td>\n",
       "      <td>65.52</td>\n",
       "      <td>9</td>\n",
       "      <td>1506.96</td>\n",
       "      <td>5/7/2004 0:00</td>\n",
       "      <td>Cancelled</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>897 Long Airport Avenue</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NYC</td>\n",
       "      <td>NY</td>\n",
       "      <td>10022</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Yu</td>\n",
       "      <td>Kwai</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2817</th>\n",
       "      <td>10337</td>\n",
       "      <td>42</td>\n",
       "      <td>97.16</td>\n",
       "      <td>5</td>\n",
       "      <td>4080.72</td>\n",
       "      <td>11/21/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>11</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>5905 Pompton St.</td>\n",
       "      <td>Suite 750</td>\n",
       "      <td>NYC</td>\n",
       "      <td>NY</td>\n",
       "      <td>10022</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hernandez</td>\n",
       "      <td>Maria</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2822</th>\n",
       "      <td>10414</td>\n",
       "      <td>47</td>\n",
       "      <td>65.52</td>\n",
       "      <td>9</td>\n",
       "      <td>3079.44</td>\n",
       "      <td>5/6/2005 0:00</td>\n",
       "      <td>On Hold</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>8616 Spinnaker Dr.</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Boston</td>\n",
       "      <td>MA</td>\n",
       "      <td>51003</td>\n",
       "      <td>USA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Yoshido</td>\n",
       "      <td>Juri</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1004 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      ORDERNUMBER  QUANTITYORDERED  PRICEEACH  ORDERLINENUMBER    SALES  \\\n",
       "0           10107               30      95.70                2  2871.00   \n",
       "3           10145               45      83.26                6  3746.70   \n",
       "4           10159               49     100.00               14  5205.27   \n",
       "5           10168               36      96.66                1  3479.76   \n",
       "8           10201               22      98.57                2  2168.54   \n",
       "...           ...              ...        ...              ...      ...   \n",
       "2804        10185               28      64.43                6  1804.04   \n",
       "2807        10222               36      63.34               18  2280.24   \n",
       "2809        10248               23      65.52                9  1506.96   \n",
       "2817        10337               42      97.16                5  4080.72   \n",
       "2822        10414               47      65.52                9  3079.44   \n",
       "\n",
       "            ORDERDATE     STATUS  QTR_ID  MONTH_ID  YEAR_ID  ...  \\\n",
       "0      2/24/2003 0:00    Shipped       1         2     2003  ...   \n",
       "3      8/25/2003 0:00    Shipped       3         8     2003  ...   \n",
       "4     10/10/2003 0:00    Shipped       4        10     2003  ...   \n",
       "5     10/28/2003 0:00    Shipped       4        10     2003  ...   \n",
       "8      12/1/2003 0:00    Shipped       4        12     2003  ...   \n",
       "...               ...        ...     ...       ...      ...  ...   \n",
       "2804  11/14/2003 0:00    Shipped       4        11     2003  ...   \n",
       "2807   2/19/2004 0:00    Shipped       1         2     2004  ...   \n",
       "2809    5/7/2004 0:00  Cancelled       2         5     2004  ...   \n",
       "2817  11/21/2004 0:00    Shipped       4        11     2004  ...   \n",
       "2822    5/6/2005 0:00    On Hold       2         5     2005  ...   \n",
       "\n",
       "                   ADDRESSLINE1  ADDRESSLINE2           CITY STATE POSTALCODE  \\\n",
       "0       897 Long Airport Avenue           NaN            NYC    NY      10022   \n",
       "3            78934 Hillside Dr.           NaN       Pasadena    CA      90003   \n",
       "4               7734 Strong St.           NaN  San Francisco    CA        NaN   \n",
       "5             9408 Furth Circle           NaN     Burlingame    CA      94217   \n",
       "8     5557 North Pendale Street           NaN  San Francisco    CA        NaN   \n",
       "...                         ...           ...            ...   ...        ...   \n",
       "2804          4575 Hillside Dr.           NaN    New Bedford    MA      50553   \n",
       "2807           361 Furth Circle           NaN      San Diego    CA      91217   \n",
       "2809    897 Long Airport Avenue           NaN            NYC    NY      10022   \n",
       "2817           5905 Pompton St.     Suite 750            NYC    NY      10022   \n",
       "2822         8616 Spinnaker Dr.           NaN         Boston    MA      51003   \n",
       "\n",
       "     COUNTRY TERRITORY CONTACTLASTNAME CONTACTFIRSTNAME DEALSIZE  \n",
       "0        USA       NaN              Yu             Kwai    Small  \n",
       "3        USA       NaN           Young            Julie   Medium  \n",
       "4        USA       NaN           Brown            Julie   Medium  \n",
       "5        USA       NaN          Hirano             Juri   Medium  \n",
       "8        USA       NaN          Murphy            Julie    Small  \n",
       "...      ...       ...             ...              ...      ...  \n",
       "2804     USA       NaN             Tam           Wing C    Small  \n",
       "2807     USA       NaN        Thompson          Valarie    Small  \n",
       "2809     USA       NaN              Yu             Kwai    Small  \n",
       "2817     USA       NaN       Hernandez            Maria   Medium  \n",
       "2822     USA       NaN         Yoshido             Juri   Medium  \n",
       "\n",
       "[1004 rows x 25 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sales_data.loc[sales_data['COUNTRY']=='USA'] # NaN - Has the missing values "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2aa7c631",
   "metadata": {
    "papermill": {
     "duration": 0.014608,
     "end_time": "2024-08-23T13:44:09.142917",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.128309",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "- Need to get replace NA values\n",
    "- When looking at data set can see the **NA values** occur next to **USA**\n",
    "- There are many territoties in America so can't chose a specific one, so i am going to replace the **America**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "a5602d20",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.174696Z",
     "iopub.status.busy": "2024-08-23T13:44:09.174295Z",
     "iopub.status.idle": "2024-08-23T13:44:09.181450Z",
     "shell.execute_reply": "2024-08-23T13:44:09.180266Z"
    },
    "papermill": {
     "duration": 0.026136,
     "end_time": "2024-08-23T13:44:09.184248",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.158112",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Filling the NAN values\n",
    "# First with territory \n",
    "\n",
    "sales_data['TERRITORY'] = sales_data['TERRITORY'].fillna('America')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "2985b9f4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.216418Z",
     "iopub.status.busy": "2024-08-23T13:44:09.215547Z",
     "iopub.status.idle": "2024-08-23T13:44:09.224425Z",
     "shell.execute_reply": "2024-08-23T13:44:09.223251Z"
    },
    "papermill": {
     "duration": 0.027611,
     "end_time": "2024-08-23T13:44:09.227012",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.199401",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['NY', nan, 'CA', 'Victoria', 'NJ', 'CT', 'MA', 'PA', 'NSW',\n",
       "       'Queensland', 'BC', 'Tokyo', 'NH', 'Quebec', 'Osaka',\n",
       "       'Isle of Wight', 'NV'], dtype=object)"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Now to replace state\n",
    "# Checking to see the state values and nan\n",
    "sales_data.STATE.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "4a36412d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.258577Z",
     "iopub.status.busy": "2024-08-23T13:44:09.258143Z",
     "iopub.status.idle": "2024-08-23T13:44:09.273598Z",
     "shell.execute_reply": "2024-08-23T13:44:09.272503Z"
    },
    "papermill": {
     "duration": 0.034116,
     "end_time": "2024-08-23T13:44:09.276119",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.242003",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ORDERNUMBER            0\n",
       "QUANTITYORDERED        0\n",
       "PRICEEACH              0\n",
       "ORDERLINENUMBER        0\n",
       "SALES                  0\n",
       "ORDERDATE              0\n",
       "STATUS                 0\n",
       "QTR_ID                 0\n",
       "MONTH_ID               0\n",
       "YEAR_ID                0\n",
       "PRODUCTLINE            0\n",
       "MSRP                   0\n",
       "PRODUCTCODE            0\n",
       "CUSTOMERNAME           0\n",
       "PHONE                  0\n",
       "ADDRESSLINE1           0\n",
       "ADDRESSLINE2        2521\n",
       "CITY                   0\n",
       "STATE               1486\n",
       "POSTALCODE            76\n",
       "COUNTRY                0\n",
       "TERRITORY              0\n",
       "CONTACTLASTNAME        0\n",
       "CONTACTFIRSTNAME       0\n",
       "DEALSIZE               0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Check to see all the missing values in the TERRITORY Column has been replaced\n",
    "\n",
    "sales_data.isna().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1204a7d6",
   "metadata": {
    "papermill": {
     "duration": 0.015066,
     "end_time": "2024-08-23T13:44:09.306372",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.291306",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "They have been replaced, just need to sort postal code, state, and addressline2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "5661db70",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.339965Z",
     "iopub.status.busy": "2024-08-23T13:44:09.339490Z",
     "iopub.status.idle": "2024-08-23T13:44:09.348765Z",
     "shell.execute_reply": "2024-08-23T13:44:09.347445Z"
    },
    "papermill": {
     "duration": 0.028885,
     "end_time": "2024-08-23T13:44:09.351586",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.322701",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['NY', nan, 'CA', 'Victoria', 'NJ', 'CT', 'MA', 'PA', 'NSW',\n",
       "       'Queensland', 'BC', 'Tokyo', 'NH', 'Quebec', 'Osaka',\n",
       "       'Isle of Wight', 'NV'], dtype=object)"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sales_data.STATE.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "6c914959",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.384930Z",
     "iopub.status.busy": "2024-08-23T13:44:09.384497Z",
     "iopub.status.idle": "2024-08-23T13:44:09.393502Z",
     "shell.execute_reply": "2024-08-23T13:44:09.392202Z"
    },
    "papermill": {
     "duration": 0.028666,
     "end_time": "2024-08-23T13:44:09.396001",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.367335",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['NYC', 'Reims', 'Paris', 'Pasadena', 'San Francisco', 'Burlingame',\n",
       "       'Lille', 'Bergen', 'Melbourne', 'Newark', 'Bridgewater', 'Nantes',\n",
       "       'Cambridge', 'Helsinki', 'Stavern', 'Allentown', 'Salzburg',\n",
       "       'Chatswood', 'New Bedford', 'Liverpool', 'Madrid', 'Lule',\n",
       "       'Singapore', 'South Brisbane', 'Philadelphia', 'Lyon', 'Vancouver',\n",
       "       'Burbank', 'New Haven', 'Minato-ku', 'Torino', 'Boras',\n",
       "       'Versailles', 'San Rafael', 'Nashua', 'Brickhaven', 'North Sydney',\n",
       "       'Montreal', 'Osaka', 'White Plains', 'Kobenhavn', 'London',\n",
       "       'Toulouse', 'Barcelona', 'Los Angeles', 'San Diego', 'Bruxelles',\n",
       "       'Tsawassen', 'Boston', 'Cowes', 'Oulu', 'San Jose', 'Graz',\n",
       "       'Makati City', 'Marseille', 'Koln', 'Gensve', 'Reggio Emilia',\n",
       "       'Frankfurt', 'Espoo', 'Dublin', 'Manchester', 'Aaarhus',\n",
       "       'Glendale', 'Sevilla', 'Brisbane', 'Strasbourg', 'Las Vegas',\n",
       "       'Oslo', 'Bergamo', 'Glen Waverly', 'Munich', 'Charleroi'],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sales_data.CITY.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "02eaaddc",
   "metadata": {
    "collapsed": true,
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.428751Z",
     "iopub.status.busy": "2024-08-23T13:44:09.428333Z",
     "iopub.status.idle": "2024-08-23T13:44:09.482456Z",
     "shell.execute_reply": "2024-08-23T13:44:09.481320Z"
    },
    "jupyter": {
     "outputs_hidden": true
    },
    "papermill": {
     "duration": 0.074222,
     "end_time": "2024-08-23T13:44:09.485815",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.411593",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ORDERNUMBER</th>\n",
       "      <th>QUANTITYORDERED</th>\n",
       "      <th>PRICEEACH</th>\n",
       "      <th>ORDERLINENUMBER</th>\n",
       "      <th>SALES</th>\n",
       "      <th>ORDERDATE</th>\n",
       "      <th>STATUS</th>\n",
       "      <th>QTR_ID</th>\n",
       "      <th>MONTH_ID</th>\n",
       "      <th>YEAR_ID</th>\n",
       "      <th>...</th>\n",
       "      <th>ADDRESSLINE1</th>\n",
       "      <th>ADDRESSLINE2</th>\n",
       "      <th>CITY</th>\n",
       "      <th>STATE</th>\n",
       "      <th>POSTALCODE</th>\n",
       "      <th>COUNTRY</th>\n",
       "      <th>TERRITORY</th>\n",
       "      <th>CONTACTLASTNAME</th>\n",
       "      <th>CONTACTFIRSTNAME</th>\n",
       "      <th>DEALSIZE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10121</td>\n",
       "      <td>34</td>\n",
       "      <td>81.35</td>\n",
       "      <td>5</td>\n",
       "      <td>2765.90</td>\n",
       "      <td>5/7/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>127</th>\n",
       "      <td>10359</td>\n",
       "      <td>48</td>\n",
       "      <td>54.68</td>\n",
       "      <td>6</td>\n",
       "      <td>2624.64</td>\n",
       "      <td>12/15/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>12</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>207</th>\n",
       "      <td>10359</td>\n",
       "      <td>42</td>\n",
       "      <td>100.00</td>\n",
       "      <td>8</td>\n",
       "      <td>4764.48</td>\n",
       "      <td>12/15/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>12</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>241</th>\n",
       "      <td>10121</td>\n",
       "      <td>50</td>\n",
       "      <td>100.00</td>\n",
       "      <td>4</td>\n",
       "      <td>8284.00</td>\n",
       "      <td>5/7/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Large</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>337</th>\n",
       "      <td>10359</td>\n",
       "      <td>49</td>\n",
       "      <td>62.09</td>\n",
       "      <td>5</td>\n",
       "      <td>3042.41</td>\n",
       "      <td>12/15/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>12</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>529</th>\n",
       "      <td>10137</td>\n",
       "      <td>44</td>\n",
       "      <td>99.55</td>\n",
       "      <td>2</td>\n",
       "      <td>4380.20</td>\n",
       "      <td>7/10/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>547</th>\n",
       "      <td>10343</td>\n",
       "      <td>36</td>\n",
       "      <td>100.00</td>\n",
       "      <td>4</td>\n",
       "      <td>5848.92</td>\n",
       "      <td>11/24/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>11</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>575</th>\n",
       "      <td>10398</td>\n",
       "      <td>33</td>\n",
       "      <td>100.00</td>\n",
       "      <td>11</td>\n",
       "      <td>4215.09</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>801</th>\n",
       "      <td>10398</td>\n",
       "      <td>34</td>\n",
       "      <td>76.88</td>\n",
       "      <td>15</td>\n",
       "      <td>2613.92</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>858</th>\n",
       "      <td>10137</td>\n",
       "      <td>37</td>\n",
       "      <td>100.00</td>\n",
       "      <td>3</td>\n",
       "      <td>4346.76</td>\n",
       "      <td>7/10/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>876</th>\n",
       "      <td>10343</td>\n",
       "      <td>25</td>\n",
       "      <td>52.32</td>\n",
       "      <td>3</td>\n",
       "      <td>1308.00</td>\n",
       "      <td>11/24/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>11</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>958</th>\n",
       "      <td>10398</td>\n",
       "      <td>28</td>\n",
       "      <td>72.26</td>\n",
       "      <td>18</td>\n",
       "      <td>2023.28</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1167</th>\n",
       "      <td>10137</td>\n",
       "      <td>31</td>\n",
       "      <td>100.00</td>\n",
       "      <td>4</td>\n",
       "      <td>5124.30</td>\n",
       "      <td>7/10/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1185</th>\n",
       "      <td>10343</td>\n",
       "      <td>44</td>\n",
       "      <td>84.88</td>\n",
       "      <td>2</td>\n",
       "      <td>3734.72</td>\n",
       "      <td>11/24/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>11</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1238</th>\n",
       "      <td>10398</td>\n",
       "      <td>45</td>\n",
       "      <td>100.00</td>\n",
       "      <td>17</td>\n",
       "      <td>4811.85</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1494</th>\n",
       "      <td>10137</td>\n",
       "      <td>26</td>\n",
       "      <td>49.81</td>\n",
       "      <td>1</td>\n",
       "      <td>1295.06</td>\n",
       "      <td>7/10/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>3</td>\n",
       "      <td>7</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1511</th>\n",
       "      <td>10343</td>\n",
       "      <td>27</td>\n",
       "      <td>36.21</td>\n",
       "      <td>6</td>\n",
       "      <td>977.67</td>\n",
       "      <td>11/24/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>11</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1536</th>\n",
       "      <td>10398</td>\n",
       "      <td>43</td>\n",
       "      <td>100.00</td>\n",
       "      <td>16</td>\n",
       "      <td>5552.16</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1669</th>\n",
       "      <td>10121</td>\n",
       "      <td>32</td>\n",
       "      <td>76.88</td>\n",
       "      <td>2</td>\n",
       "      <td>2460.16</td>\n",
       "      <td>5/7/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1767</th>\n",
       "      <td>10398</td>\n",
       "      <td>28</td>\n",
       "      <td>57.55</td>\n",
       "      <td>3</td>\n",
       "      <td>1611.40</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1918</th>\n",
       "      <td>10398</td>\n",
       "      <td>34</td>\n",
       "      <td>71.67</td>\n",
       "      <td>13</td>\n",
       "      <td>2436.78</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>10398</td>\n",
       "      <td>41</td>\n",
       "      <td>68.24</td>\n",
       "      <td>2</td>\n",
       "      <td>2797.84</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2067</th>\n",
       "      <td>10359</td>\n",
       "      <td>22</td>\n",
       "      <td>100.00</td>\n",
       "      <td>7</td>\n",
       "      <td>2603.04</td>\n",
       "      <td>12/15/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>12</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2119</th>\n",
       "      <td>10398</td>\n",
       "      <td>45</td>\n",
       "      <td>78.25</td>\n",
       "      <td>14</td>\n",
       "      <td>3521.25</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2141</th>\n",
       "      <td>10343</td>\n",
       "      <td>30</td>\n",
       "      <td>100.00</td>\n",
       "      <td>1</td>\n",
       "      <td>3098.70</td>\n",
       "      <td>11/24/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>11</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2216</th>\n",
       "      <td>10343</td>\n",
       "      <td>29</td>\n",
       "      <td>100.00</td>\n",
       "      <td>5</td>\n",
       "      <td>3713.16</td>\n",
       "      <td>11/24/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>11</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2244</th>\n",
       "      <td>10359</td>\n",
       "      <td>36</td>\n",
       "      <td>100.00</td>\n",
       "      <td>3</td>\n",
       "      <td>6358.68</td>\n",
       "      <td>12/15/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>12</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2271</th>\n",
       "      <td>10359</td>\n",
       "      <td>22</td>\n",
       "      <td>100.00</td>\n",
       "      <td>1</td>\n",
       "      <td>4301.22</td>\n",
       "      <td>12/15/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>12</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2324</th>\n",
       "      <td>10398</td>\n",
       "      <td>22</td>\n",
       "      <td>67.41</td>\n",
       "      <td>4</td>\n",
       "      <td>1483.02</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2328</th>\n",
       "      <td>10121</td>\n",
       "      <td>25</td>\n",
       "      <td>86.74</td>\n",
       "      <td>3</td>\n",
       "      <td>2168.50</td>\n",
       "      <td>5/7/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2375</th>\n",
       "      <td>10398</td>\n",
       "      <td>49</td>\n",
       "      <td>36.66</td>\n",
       "      <td>5</td>\n",
       "      <td>1796.34</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2400</th>\n",
       "      <td>10359</td>\n",
       "      <td>46</td>\n",
       "      <td>100.00</td>\n",
       "      <td>2</td>\n",
       "      <td>4896.70</td>\n",
       "      <td>12/15/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>12</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2427</th>\n",
       "      <td>10359</td>\n",
       "      <td>25</td>\n",
       "      <td>64.93</td>\n",
       "      <td>4</td>\n",
       "      <td>1623.25</td>\n",
       "      <td>12/15/2004 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>4</td>\n",
       "      <td>12</td>\n",
       "      <td>2004</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2433</th>\n",
       "      <td>10121</td>\n",
       "      <td>44</td>\n",
       "      <td>74.85</td>\n",
       "      <td>1</td>\n",
       "      <td>3293.40</td>\n",
       "      <td>5/7/2003 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>2003</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2506</th>\n",
       "      <td>10398</td>\n",
       "      <td>47</td>\n",
       "      <td>87.69</td>\n",
       "      <td>6</td>\n",
       "      <td>4121.43</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2558</th>\n",
       "      <td>10398</td>\n",
       "      <td>36</td>\n",
       "      <td>100.00</td>\n",
       "      <td>7</td>\n",
       "      <td>3910.32</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2585</th>\n",
       "      <td>10398</td>\n",
       "      <td>22</td>\n",
       "      <td>86.76</td>\n",
       "      <td>8</td>\n",
       "      <td>1908.72</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2663</th>\n",
       "      <td>10398</td>\n",
       "      <td>23</td>\n",
       "      <td>100.00</td>\n",
       "      <td>9</td>\n",
       "      <td>2810.83</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2688</th>\n",
       "      <td>10398</td>\n",
       "      <td>29</td>\n",
       "      <td>65.60</td>\n",
       "      <td>10</td>\n",
       "      <td>1902.40</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2767</th>\n",
       "      <td>10398</td>\n",
       "      <td>36</td>\n",
       "      <td>87.36</td>\n",
       "      <td>12</td>\n",
       "      <td>3144.96</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Medium</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2794</th>\n",
       "      <td>10398</td>\n",
       "      <td>34</td>\n",
       "      <td>40.22</td>\n",
       "      <td>1</td>\n",
       "      <td>1367.48</td>\n",
       "      <td>3/30/2005 0:00</td>\n",
       "      <td>Shipped</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2005</td>\n",
       "      <td>...</td>\n",
       "      <td>59 rue de l'Abbaye</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Reims</td>\n",
       "      <td>NaN</td>\n",
       "      <td>51100</td>\n",
       "      <td>France</td>\n",
       "      <td>EMEA</td>\n",
       "      <td>Henriot</td>\n",
       "      <td>Paul</td>\n",
       "      <td>Small</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>41 rows × 25 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      ORDERNUMBER  QUANTITYORDERED  PRICEEACH  ORDERLINENUMBER    SALES  \\\n",
       "1           10121               34      81.35                5  2765.90   \n",
       "127         10359               48      54.68                6  2624.64   \n",
       "207         10359               42     100.00                8  4764.48   \n",
       "241         10121               50     100.00                4  8284.00   \n",
       "337         10359               49      62.09                5  3042.41   \n",
       "529         10137               44      99.55                2  4380.20   \n",
       "547         10343               36     100.00                4  5848.92   \n",
       "575         10398               33     100.00               11  4215.09   \n",
       "801         10398               34      76.88               15  2613.92   \n",
       "858         10137               37     100.00                3  4346.76   \n",
       "876         10343               25      52.32                3  1308.00   \n",
       "958         10398               28      72.26               18  2023.28   \n",
       "1167        10137               31     100.00                4  5124.30   \n",
       "1185        10343               44      84.88                2  3734.72   \n",
       "1238        10398               45     100.00               17  4811.85   \n",
       "1494        10137               26      49.81                1  1295.06   \n",
       "1511        10343               27      36.21                6   977.67   \n",
       "1536        10398               43     100.00               16  5552.16   \n",
       "1669        10121               32      76.88                2  2460.16   \n",
       "1767        10398               28      57.55                3  1611.40   \n",
       "1918        10398               34      71.67               13  2436.78   \n",
       "2021        10398               41      68.24                2  2797.84   \n",
       "2067        10359               22     100.00                7  2603.04   \n",
       "2119        10398               45      78.25               14  3521.25   \n",
       "2141        10343               30     100.00                1  3098.70   \n",
       "2216        10343               29     100.00                5  3713.16   \n",
       "2244        10359               36     100.00                3  6358.68   \n",
       "2271        10359               22     100.00                1  4301.22   \n",
       "2324        10398               22      67.41                4  1483.02   \n",
       "2328        10121               25      86.74                3  2168.50   \n",
       "2375        10398               49      36.66                5  1796.34   \n",
       "2400        10359               46     100.00                2  4896.70   \n",
       "2427        10359               25      64.93                4  1623.25   \n",
       "2433        10121               44      74.85                1  3293.40   \n",
       "2506        10398               47      87.69                6  4121.43   \n",
       "2558        10398               36     100.00                7  3910.32   \n",
       "2585        10398               22      86.76                8  1908.72   \n",
       "2663        10398               23     100.00                9  2810.83   \n",
       "2688        10398               29      65.60               10  1902.40   \n",
       "2767        10398               36      87.36               12  3144.96   \n",
       "2794        10398               34      40.22                1  1367.48   \n",
       "\n",
       "            ORDERDATE   STATUS  QTR_ID  MONTH_ID  YEAR_ID  ...  \\\n",
       "1       5/7/2003 0:00  Shipped       2         5     2003  ...   \n",
       "127   12/15/2004 0:00  Shipped       4        12     2004  ...   \n",
       "207   12/15/2004 0:00  Shipped       4        12     2004  ...   \n",
       "241     5/7/2003 0:00  Shipped       2         5     2003  ...   \n",
       "337   12/15/2004 0:00  Shipped       4        12     2004  ...   \n",
       "529    7/10/2003 0:00  Shipped       3         7     2003  ...   \n",
       "547   11/24/2004 0:00  Shipped       4        11     2004  ...   \n",
       "575    3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "801    3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "858    7/10/2003 0:00  Shipped       3         7     2003  ...   \n",
       "876   11/24/2004 0:00  Shipped       4        11     2004  ...   \n",
       "958    3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "1167   7/10/2003 0:00  Shipped       3         7     2003  ...   \n",
       "1185  11/24/2004 0:00  Shipped       4        11     2004  ...   \n",
       "1238   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "1494   7/10/2003 0:00  Shipped       3         7     2003  ...   \n",
       "1511  11/24/2004 0:00  Shipped       4        11     2004  ...   \n",
       "1536   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "1669    5/7/2003 0:00  Shipped       2         5     2003  ...   \n",
       "1767   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "1918   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "2021   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "2067  12/15/2004 0:00  Shipped       4        12     2004  ...   \n",
       "2119   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "2141  11/24/2004 0:00  Shipped       4        11     2004  ...   \n",
       "2216  11/24/2004 0:00  Shipped       4        11     2004  ...   \n",
       "2244  12/15/2004 0:00  Shipped       4        12     2004  ...   \n",
       "2271  12/15/2004 0:00  Shipped       4        12     2004  ...   \n",
       "2324   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "2328    5/7/2003 0:00  Shipped       2         5     2003  ...   \n",
       "2375   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "2400  12/15/2004 0:00  Shipped       4        12     2004  ...   \n",
       "2427  12/15/2004 0:00  Shipped       4        12     2004  ...   \n",
       "2433    5/7/2003 0:00  Shipped       2         5     2003  ...   \n",
       "2506   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "2558   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "2585   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "2663   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "2688   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "2767   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "2794   3/30/2005 0:00  Shipped       1         3     2005  ...   \n",
       "\n",
       "            ADDRESSLINE1  ADDRESSLINE2   CITY STATE POSTALCODE COUNTRY  \\\n",
       "1     59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "127   59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "207   59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "241   59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "337   59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "529   59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "547   59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "575   59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "801   59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "858   59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "876   59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "958   59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "1167  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "1185  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "1238  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "1494  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "1511  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "1536  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "1669  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "1767  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "1918  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2021  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2067  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2119  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2141  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2216  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2244  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2271  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2324  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2328  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2375  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2400  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2427  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2433  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2506  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2558  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2585  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2663  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2688  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2767  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "2794  59 rue de l'Abbaye           NaN  Reims   NaN      51100  France   \n",
       "\n",
       "     TERRITORY CONTACTLASTNAME CONTACTFIRSTNAME DEALSIZE  \n",
       "1         EMEA         Henriot             Paul    Small  \n",
       "127       EMEA         Henriot             Paul    Small  \n",
       "207       EMEA         Henriot             Paul   Medium  \n",
       "241       EMEA         Henriot             Paul    Large  \n",
       "337       EMEA         Henriot             Paul   Medium  \n",
       "529       EMEA         Henriot             Paul   Medium  \n",
       "547       EMEA         Henriot             Paul   Medium  \n",
       "575       EMEA         Henriot             Paul   Medium  \n",
       "801       EMEA         Henriot             Paul    Small  \n",
       "858       EMEA         Henriot             Paul   Medium  \n",
       "876       EMEA         Henriot             Paul    Small  \n",
       "958       EMEA         Henriot             Paul    Small  \n",
       "1167      EMEA         Henriot             Paul   Medium  \n",
       "1185      EMEA         Henriot             Paul   Medium  \n",
       "1238      EMEA         Henriot             Paul   Medium  \n",
       "1494      EMEA         Henriot             Paul    Small  \n",
       "1511      EMEA         Henriot             Paul    Small  \n",
       "1536      EMEA         Henriot             Paul   Medium  \n",
       "1669      EMEA         Henriot             Paul    Small  \n",
       "1767      EMEA         Henriot             Paul    Small  \n",
       "1918      EMEA         Henriot             Paul    Small  \n",
       "2021      EMEA         Henriot             Paul    Small  \n",
       "2067      EMEA         Henriot             Paul    Small  \n",
       "2119      EMEA         Henriot             Paul   Medium  \n",
       "2141      EMEA         Henriot             Paul   Medium  \n",
       "2216      EMEA         Henriot             Paul   Medium  \n",
       "2244      EMEA         Henriot             Paul   Medium  \n",
       "2271      EMEA         Henriot             Paul   Medium  \n",
       "2324      EMEA         Henriot             Paul    Small  \n",
       "2328      EMEA         Henriot             Paul    Small  \n",
       "2375      EMEA         Henriot             Paul    Small  \n",
       "2400      EMEA         Henriot             Paul   Medium  \n",
       "2427      EMEA         Henriot             Paul    Small  \n",
       "2433      EMEA         Henriot             Paul   Medium  \n",
       "2506      EMEA         Henriot             Paul   Medium  \n",
       "2558      EMEA         Henriot             Paul   Medium  \n",
       "2585      EMEA         Henriot             Paul    Small  \n",
       "2663      EMEA         Henriot             Paul    Small  \n",
       "2688      EMEA         Henriot             Paul    Small  \n",
       "2767      EMEA         Henriot             Paul   Medium  \n",
       "2794      EMEA         Henriot             Paul    Small  \n",
       "\n",
       "[41 rows x 25 columns]"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Locating the missing values \n",
    "sales_data.loc[sales_data['CITY']=='Reims'] "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "8b9acdb2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.523604Z",
     "iopub.status.busy": "2024-08-23T13:44:09.522693Z",
     "iopub.status.idle": "2024-08-23T13:44:09.544927Z",
     "shell.execute_reply": "2024-08-23T13:44:09.543616Z"
    },
    "papermill": {
     "duration": 0.044676,
     "end_time": "2024-08-23T13:44:09.548297",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.503621",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Rows where NaN exists in 'STATE' but not in 'CITY':\n",
      "      ORDERNUMBER  QUANTITYORDERED  PRICEEACH  ORDERLINENUMBER    SALES  \\\n",
      "1           10121               34      81.35                5  2765.90   \n",
      "2           10134               41      94.74                2  3884.34   \n",
      "6           10180               29      86.13                9  2497.77   \n",
      "7           10188               48     100.00                1  5512.32   \n",
      "9           10211               41     100.00               14  4708.44   \n",
      "...           ...              ...        ...              ...      ...   \n",
      "2816        10327               37      86.74                4  3209.38   \n",
      "2818        10350               20     100.00               15  2244.40   \n",
      "2819        10373               29     100.00                1  3978.51   \n",
      "2820        10386               43     100.00                4  5417.57   \n",
      "2821        10397               34      62.24                1  2116.16   \n",
      "\n",
      "            ORDERDATE    STATUS  QTR_ID  MONTH_ID  YEAR_ID  ...  \\\n",
      "1       5/7/2003 0:00   Shipped       2         5     2003  ...   \n",
      "2       7/1/2003 0:00   Shipped       3         7     2003  ...   \n",
      "6     11/11/2003 0:00   Shipped       4        11     2003  ...   \n",
      "7     11/18/2003 0:00   Shipped       4        11     2003  ...   \n",
      "9      1/15/2004 0:00   Shipped       1         1     2004  ...   \n",
      "...               ...       ...     ...       ...      ...  ...   \n",
      "2816  11/10/2004 0:00  Resolved       4        11     2004  ...   \n",
      "2818   12/2/2004 0:00   Shipped       4        12     2004  ...   \n",
      "2819   1/31/2005 0:00   Shipped       1         1     2005  ...   \n",
      "2820    3/1/2005 0:00  Resolved       1         3     2005  ...   \n",
      "2821   3/28/2005 0:00   Shipped       1         3     2005  ...   \n",
      "\n",
      "                       ADDRESSLINE1  ADDRESSLINE2       CITY STATE POSTALCODE  \\\n",
      "1                59 rue de l'Abbaye           NaN      Reims   NaN      51100   \n",
      "2     27 rue du Colonel Pierre Avia           NaN      Paris   NaN      75508   \n",
      "6           184, chausse de Tournai           NaN      Lille   NaN      59000   \n",
      "7       Drammen 121, PR 744 Sentrum           NaN     Bergen   NaN     N 5804   \n",
      "9                 25, rue Lauriston           NaN      Paris   NaN      75016   \n",
      "...                             ...           ...        ...   ...        ...   \n",
      "2816                   Vinb'ltet 34           NaN  Kobenhavn   NaN       1734   \n",
      "2818             C/ Moralzarzal, 86           NaN     Madrid   NaN      28034   \n",
      "2819                    Torikatu 38           NaN       Oulu   NaN      90110   \n",
      "2820             C/ Moralzarzal, 86           NaN     Madrid   NaN      28034   \n",
      "2821          1 rue Alsace-Lorraine           NaN   Toulouse   NaN      31000   \n",
      "\n",
      "      COUNTRY TERRITORY CONTACTLASTNAME CONTACTFIRSTNAME DEALSIZE  \n",
      "1      France      EMEA         Henriot             Paul    Small  \n",
      "2      France      EMEA        Da Cunha           Daniel   Medium  \n",
      "6      France      EMEA           Rance          Martine    Small  \n",
      "7      Norway      EMEA          Oeztan           Veysel   Medium  \n",
      "9      France      EMEA         Perrier        Dominique   Medium  \n",
      "...       ...       ...             ...              ...      ...  \n",
      "2816  Denmark      EMEA        Petersen            Jytte   Medium  \n",
      "2818    Spain      EMEA          Freyre            Diego    Small  \n",
      "2819  Finland      EMEA       Koskitalo           Pirkko   Medium  \n",
      "2820    Spain      EMEA          Freyre            Diego   Medium  \n",
      "2821   France      EMEA          Roulet          Annette    Small  \n",
      "\n",
      "[1486 rows x 25 columns]\n"
     ]
    }
   ],
   "source": [
    "# Better way to locate the missing values\n",
    "# Find rows where NaN exists in 'STATE' but not in 'CITY'\n",
    "\n",
    "result2 = sales_data[(sales_data['STATE'].isna()) & (sales_data['CITY'].notna())]\n",
    "print(\"Rows where NaN exists in 'STATE' but not in 'CITY':\")\n",
    "print(result2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "8fef04c8",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.585588Z",
     "iopub.status.busy": "2024-08-23T13:44:09.585129Z",
     "iopub.status.idle": "2024-08-23T13:44:09.666159Z",
     "shell.execute_reply": "2024-08-23T13:44:09.664909Z"
    },
    "papermill": {
     "duration": 0.103309,
     "end_time": "2024-08-23T13:44:09.669263",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.565954",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "      ORDERNUMBER  QUANTITYORDERED  PRICEEACH  ORDERLINENUMBER    SALES  \\\n",
      "0           10107               30      95.70                2  2871.00   \n",
      "1           10121               34      81.35                5  2765.90   \n",
      "2           10134               41      94.74                2  3884.34   \n",
      "3           10145               45      83.26                6  3746.70   \n",
      "4           10159               49     100.00               14  5205.27   \n",
      "...           ...              ...        ...              ...      ...   \n",
      "2818        10350               20     100.00               15  2244.40   \n",
      "2819        10373               29     100.00                1  3978.51   \n",
      "2820        10386               43     100.00                4  5417.57   \n",
      "2821        10397               34      62.24                1  2116.16   \n",
      "2822        10414               47      65.52                9  3079.44   \n",
      "\n",
      "            ORDERDATE    STATUS  QTR_ID  MONTH_ID  YEAR_ID  ...  \\\n",
      "0      2/24/2003 0:00   Shipped       1         2     2003  ...   \n",
      "1       5/7/2003 0:00   Shipped       2         5     2003  ...   \n",
      "2       7/1/2003 0:00   Shipped       3         7     2003  ...   \n",
      "3      8/25/2003 0:00   Shipped       3         8     2003  ...   \n",
      "4     10/10/2003 0:00   Shipped       4        10     2003  ...   \n",
      "...               ...       ...     ...       ...      ...  ...   \n",
      "2818   12/2/2004 0:00   Shipped       4        12     2004  ...   \n",
      "2819   1/31/2005 0:00   Shipped       1         1     2005  ...   \n",
      "2820    3/1/2005 0:00  Resolved       1         3     2005  ...   \n",
      "2821   3/28/2005 0:00   Shipped       1         3     2005  ...   \n",
      "2822    5/6/2005 0:00   On Hold       2         5     2005  ...   \n",
      "\n",
      "                       ADDRESSLINE1  ADDRESSLINE2           CITY STATE  \\\n",
      "0           897 Long Airport Avenue           NaN            NYC    NY   \n",
      "1                59 rue de l'Abbaye           NaN          Reims    FR   \n",
      "2     27 rue du Colonel Pierre Avia           NaN          Paris    FR   \n",
      "3                78934 Hillside Dr.           NaN       Pasadena    CA   \n",
      "4                   7734 Strong St.           NaN  San Francisco    CA   \n",
      "...                             ...           ...            ...   ...   \n",
      "2818             C/ Moralzarzal, 86           NaN         Madrid    SP   \n",
      "2819                    Torikatu 38           NaN           Oulu    FI   \n",
      "2820             C/ Moralzarzal, 86           NaN         Madrid    SP   \n",
      "2821          1 rue Alsace-Lorraine           NaN       Toulouse   NaN   \n",
      "2822             8616 Spinnaker Dr.           NaN         Boston    MA   \n",
      "\n",
      "     POSTALCODE  COUNTRY TERRITORY CONTACTLASTNAME CONTACTFIRSTNAME DEALSIZE  \n",
      "0         10022      USA   America              Yu             Kwai    Small  \n",
      "1         51100   France      EMEA         Henriot             Paul    Small  \n",
      "2         75508   France      EMEA        Da Cunha           Daniel   Medium  \n",
      "3         90003      USA   America           Young            Julie   Medium  \n",
      "4           NaN      USA   America           Brown            Julie   Medium  \n",
      "...         ...      ...       ...             ...              ...      ...  \n",
      "2818      28034    Spain      EMEA          Freyre            Diego    Small  \n",
      "2819      90110  Finland      EMEA       Koskitalo           Pirkko   Medium  \n",
      "2820      28034    Spain      EMEA          Freyre            Diego   Medium  \n",
      "2821      31000   France      EMEA          Roulet          Annette    Small  \n",
      "2822      51003      USA   America         Yoshido             Juri   Medium  \n",
      "\n",
      "[2823 rows x 25 columns]\n"
     ]
    }
   ],
   "source": [
    "# Replacing the NaN in STATE to match the The CITY\n",
    "\n",
    "sales_data.loc[sales_data['CITY'] == 'Reims', 'STATE'] = 'FR'\n",
    "sales_data.loc[sales_data['CITY'] == 'Madrid', 'STATE'] = 'SP'\n",
    "sales_data.loc[sales_data['CITY'] == 'Paris', 'STATE'] = 'FR'\n",
    "sales_data.loc[sales_data['CITY'] == 'Oulu', 'STATE'] = 'FI'\n",
    "sales_data.loc[sales_data['CITY'] == 'Lile', 'STATE'] = 'FR'\n",
    "sales_data.loc[sales_data['CITY'] == 'Bergen', 'STATE'] = 'NO'\n",
    "sales_data.loc[sales_data['CITY'] == 'Nantes', 'STATE'] = 'FR'\n",
    "sales_data.loc[sales_data['CITY'] == 'Helsinki', 'STATE'] = 'FI'\n",
    "sales_data.loc[sales_data['CITY'] == 'Stavern', 'STATE'] = 'NO'\n",
    "sales_data.loc[sales_data['CITY'] == 'Bruxelles', 'STATE'] = 'BE'\n",
    "sales_data.loc[sales_data['CITY'] == 'Torino', 'STATE'] = 'IT'\n",
    "sales_data.loc[sales_data['CITY'] == 'Manchester', 'STATE'] = 'ENG'\n",
    "sales_data.loc[sales_data['CITY'] == 'Kobenhavn', 'STATE'] = 'DK'\n",
    "sales_data.loc[sales_data['CITY'] == 'Lille', 'STATE'] = 'FR'\n",
    "sales_data.loc[sales_data['CITY'] == 'Salzburg', 'STATE'] = 'DE'\n",
    "sales_data.loc[sales_data['CITY'] == 'Liverpool', 'STATE'] = 'ENG'\n",
    "sales_data.loc[sales_data['CITY'] == 'Lule', 'STATE'] = 'SE'\n",
    "sales_data.loc[sales_data['CITY'] == 'Singapore', 'STATE'] = 'SG'\n",
    "sales_data.loc[sales_data['CITY'] == 'London', 'STATE'] = 'ENG'\n",
    "sales_data.loc[sales_data['CITY'] == 'Boras', 'STATE'] = 'SE'\n",
    "sales_data.loc[sales_data['CITY'] == 'Barcelona', 'STATE'] = 'ES'\n",
    "sales_data.loc[sales_data['CITY'] == 'Lyon', 'STATE'] = 'FR'\n",
    "sales_data.loc[sales_data['CITY'] == 'Versailles', 'STATE'] = 'FR'\n",
    "sales_data.loc[sales_data['CITY'] == 'Graz', 'STATE'] = 'AT'\n",
    "sales_data.loc[sales_data['CITY'] == 'Makati City', 'STATE'] = 'PH'\n",
    "sales_data.loc[sales_data['CITY'] == 'Marseille', 'STATE'] = 'FR'\n",
    "sales_data.loc[sales_data['CITY'] == 'Koln', 'STATE'] = 'DE'\n",
    "sales_data.loc[sales_data['CITY'] == 'Munich', 'STATE'] = 'DE'\n",
    "sales_data.loc[sales_data['CITY'] == 'Bergamo', 'STATE'] = 'IT'\n",
    "sales_data.loc[sales_data['CITY'] == 'Reggio Emilia', 'STATE'] = 'IT'\n",
    "sales_data.loc[sales_data['CITY'] == 'Gensve', 'STATE'] = 'CH'\n",
    "sales_data.loc[sales_data['CITY'] == 'Frankfurt', 'STATE'] = 'DE'\n",
    "sales_data.loc[sales_data['CITY'] == 'Espoo', 'STATE'] = 'FI'\n",
    "sales_data.loc[sales_data['CITY'] == 'Dublin', 'STATE'] = 'IE'\n",
    "sales_data.loc[sales_data['CITY'] == 'Aaarhusa', 'STATE'] = 'DK'\n",
    "sales_data.loc[sales_data['CITY'] == 'Oslo', 'STATE'] = 'NO'\n",
    "sales_data.loc[sales_data['CITY'] == 'Aaarhus', 'STATE'] = 'DK'\n",
    "sales_data.loc[sales_data['CITY'] == 'Sevilla', 'STATE'] = 'ES'\n",
    "sales_data.loc[sales_data['CITY'] == 'Charleroi', 'STATE'] = 'BE'\n",
    "sales_data.loc[sales_data['CITY'] == 'Strasbourg', 'STATE'] = 'FR'\n",
    "print(sales_data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "d4467fa9",
   "metadata": {
    "collapsed": true,
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.706506Z",
     "iopub.status.busy": "2024-08-23T13:44:09.706075Z",
     "iopub.status.idle": "2024-08-23T13:44:09.721985Z",
     "shell.execute_reply": "2024-08-23T13:44:09.720729Z"
    },
    "jupyter": {
     "outputs_hidden": true
    },
    "papermill": {
     "duration": 0.03845,
     "end_time": "2024-08-23T13:44:09.725315",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.686865",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ORDERNUMBER            0\n",
       "QUANTITYORDERED        0\n",
       "PRICEEACH              0\n",
       "ORDERLINENUMBER        0\n",
       "SALES                  0\n",
       "ORDERDATE              0\n",
       "STATUS                 0\n",
       "QTR_ID                 0\n",
       "MONTH_ID               0\n",
       "YEAR_ID                0\n",
       "PRODUCTLINE            0\n",
       "MSRP                   0\n",
       "PRODUCTCODE            0\n",
       "CUSTOMERNAME           0\n",
       "PHONE                  0\n",
       "ADDRESSLINE1           0\n",
       "ADDRESSLINE2        2521\n",
       "CITY                   0\n",
       "STATE                 20\n",
       "POSTALCODE            76\n",
       "COUNTRY                0\n",
       "TERRITORY              0\n",
       "CONTACTLASTNAME        0\n",
       "CONTACTFIRSTNAME       0\n",
       "DEALSIZE               0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sales_data.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "9ca5800c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.762638Z",
     "iopub.status.busy": "2024-08-23T13:44:09.762232Z",
     "iopub.status.idle": "2024-08-23T13:44:09.777305Z",
     "shell.execute_reply": "2024-08-23T13:44:09.775965Z"
    },
    "papermill": {
     "duration": 0.036926,
     "end_time": "2024-08-23T13:44:09.780169",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.743243",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ORDERNUMBER            0\n",
       "QUANTITYORDERED        0\n",
       "PRICEEACH              0\n",
       "ORDERLINENUMBER        0\n",
       "SALES                  0\n",
       "ORDERDATE              0\n",
       "STATUS                 0\n",
       "QTR_ID                 0\n",
       "MONTH_ID               0\n",
       "YEAR_ID                0\n",
       "PRODUCTLINE            0\n",
       "MSRP                   0\n",
       "PRODUCTCODE            0\n",
       "CUSTOMERNAME           0\n",
       "PHONE                  0\n",
       "ADDRESSLINE1           0\n",
       "ADDRESSLINE2        2521\n",
       "CITY                   0\n",
       "STATE                 20\n",
       "POSTALCODE            76\n",
       "COUNTRY                0\n",
       "TERRITORY              0\n",
       "CONTACTLASTNAME        0\n",
       "CONTACTFIRSTNAME       0\n",
       "DEALSIZE               0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sales_data.isnull().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "af35504e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.818392Z",
     "iopub.status.busy": "2024-08-23T13:44:09.817958Z",
     "iopub.status.idle": "2024-08-23T13:44:09.825573Z",
     "shell.execute_reply": "2024-08-23T13:44:09.824302Z"
    },
    "papermill": {
     "duration": 0.029879,
     "end_time": "2024-08-23T13:44:09.828242",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.798363",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Now to remove the ADDRESSLINE2 column as most of it is empty rows and invalid\n",
    "\n",
    "sales_data = sales_data.drop('ADDRESSLINE2', axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "9c020429",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.866305Z",
     "iopub.status.busy": "2024-08-23T13:44:09.865841Z",
     "iopub.status.idle": "2024-08-23T13:44:09.887979Z",
     "shell.execute_reply": "2024-08-23T13:44:09.886686Z"
    },
    "papermill": {
     "duration": 0.044431,
     "end_time": "2024-08-23T13:44:09.890768",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.846337",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Rows where NaN exists in 'POSTALCODE' but not in 'STATE':\n",
      "      ORDERNUMBER  QUANTITYORDERED  PRICEEACH  ORDERLINENUMBER    SALES  \\\n",
      "4           10159               49     100.00               14  5205.27   \n",
      "8           10201               22      98.57                2  2168.54   \n",
      "46          10333               26     100.00                3  3003.00   \n",
      "50          10381               36     100.00                3  8254.80   \n",
      "58          10159               37     100.00               17  5016.83   \n",
      "...           ...              ...        ...              ...      ...   \n",
      "2331        10159               23     100.00               12  2347.15   \n",
      "2436        10159               31      71.60               10  2219.60   \n",
      "2531        10384               49     100.00                1  6397.44   \n",
      "2543        10209               33      88.71                4  2927.43   \n",
      "2779        10209               48      44.69                3  2145.12   \n",
      "\n",
      "            ORDERDATE   STATUS  QTR_ID  MONTH_ID  YEAR_ID  ...       PHONE  \\\n",
      "4     10/10/2003 0:00  Shipped       4        10     2003  ...  6505551386   \n",
      "8      12/1/2003 0:00  Shipped       4        12     2003  ...  6505555787   \n",
      "46    11/18/2004 0:00  Shipped       4        11     2004  ...  6505555787   \n",
      "50     2/17/2005 0:00  Shipped       1         2     2005  ...  6505551386   \n",
      "58    10/10/2003 0:00  Shipped       4        10     2003  ...  6505551386   \n",
      "...               ...      ...     ...       ...      ...  ...         ...   \n",
      "2331  10/10/2003 0:00  Shipped       4        10     2003  ...  6505551386   \n",
      "2436  10/10/2003 0:00  Shipped       4        10     2003  ...  6505551386   \n",
      "2531   2/23/2005 0:00  Shipped       1         2     2005  ...  6505551386   \n",
      "2543    1/9/2004 0:00  Shipped       1         1     2004  ...  2155554369   \n",
      "2779    1/9/2004 0:00  Shipped       1         1     2004  ...  2155554369   \n",
      "\n",
      "                   ADDRESSLINE1           CITY STATE POSTALCODE COUNTRY  \\\n",
      "4               7734 Strong St.  San Francisco    CA        NaN     USA   \n",
      "8     5557 North Pendale Street  San Francisco    CA        NaN     USA   \n",
      "46    5557 North Pendale Street  San Francisco    CA        NaN     USA   \n",
      "50              7734 Strong St.  San Francisco    CA        NaN     USA   \n",
      "58              7734 Strong St.  San Francisco    CA        NaN     USA   \n",
      "...                         ...            ...   ...        ...     ...   \n",
      "2331            7734 Strong St.  San Francisco    CA        NaN     USA   \n",
      "2436            7734 Strong St.  San Francisco    CA        NaN     USA   \n",
      "2531            7734 Strong St.  San Francisco    CA        NaN     USA   \n",
      "2543           6047 Douglas Av.    Los Angeles    CA        NaN     USA   \n",
      "2779           6047 Douglas Av.    Los Angeles    CA        NaN     USA   \n",
      "\n",
      "     TERRITORY CONTACTLASTNAME CONTACTFIRSTNAME DEALSIZE  \n",
      "4      America           Brown            Julie   Medium  \n",
      "8      America          Murphy            Julie    Small  \n",
      "46     America          Murphy            Julie   Medium  \n",
      "50     America           Brown            Julie    Large  \n",
      "58     America           Brown            Julie   Medium  \n",
      "...        ...             ...              ...      ...  \n",
      "2331   America           Brown            Julie    Small  \n",
      "2436   America           Brown            Julie    Small  \n",
      "2531   America           Brown            Julie   Medium  \n",
      "2543   America        Chandler          Michael    Small  \n",
      "2779   America        Chandler          Michael    Small  \n",
      "\n",
      "[76 rows x 24 columns]\n"
     ]
    }
   ],
   "source": [
    "# Now replacing the empty POSTALCODE entries \n",
    "# Locating where they are first \n",
    "\n",
    "result2 = sales_data[(sales_data['POSTALCODE'].isna()) & (sales_data['STATE'].notna())]\n",
    "print(\"Rows where NaN exists in 'POSTALCODE' but not in 'STATE':\")\n",
    "print(result2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "4cbcfff3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.929287Z",
     "iopub.status.busy": "2024-08-23T13:44:09.928816Z",
     "iopub.status.idle": "2024-08-23T13:44:09.936508Z",
     "shell.execute_reply": "2024-08-23T13:44:09.935295Z"
    },
    "papermill": {
     "duration": 0.030341,
     "end_time": "2024-08-23T13:44:09.939303",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.908962",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Now to locate and change the NaN entries in POSTALCODE according to their STATE\n",
    "\n",
    "sales_data.loc[sales_data['STATE'] == 'CA', 'POSTALCODE'] = '94101'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "2d8fcebd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:09.977544Z",
     "iopub.status.busy": "2024-08-23T13:44:09.977070Z",
     "iopub.status.idle": "2024-08-23T13:44:10.034767Z",
     "shell.execute_reply": "2024-08-23T13:44:10.033426Z"
    },
    "papermill": {
     "duration": 0.080378,
     "end_time": "2024-08-23T13:44:10.037824",
     "exception": false,
     "start_time": "2024-08-23T13:44:09.957446",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Saving the cleaned dataset\n",
    "\n",
    "sales_data.to_csv('cleaned_sales_data.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "94b4f356",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:10.076903Z",
     "iopub.status.busy": "2024-08-23T13:44:10.075704Z",
     "iopub.status.idle": "2024-08-23T13:44:10.103064Z",
     "shell.execute_reply": "2024-08-23T13:44:10.101733Z"
    },
    "papermill": {
     "duration": 0.049932,
     "end_time": "2024-08-23T13:44:10.105975",
     "exception": false,
     "start_time": "2024-08-23T13:44:10.056043",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Check to see if it has saved\n",
    "cleaned_sales_data = pd.read_csv('cleaned_sales_data.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "aa20d38f",
   "metadata": {
    "papermill": {
     "duration": 0.01778,
     "end_time": "2024-08-23T13:44:10.142363",
     "exception": false,
     "start_time": "2024-08-23T13:44:10.124583",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### **I have now cleaned the dataset removing all the null values**\n",
    "- Replaced the missing data (NaN) in the TERRITORY column with America corresponding to the country column.\n",
    "- Replaced the missing data in the STATE column with the STATE correspondng to the CITY\n",
    "- Dropped the ADDRESSLINE2 column which took up 86.3% of the data with missing values\n",
    "- Replaced the na's in the POSTALCODE column with '94101' corresponding to CA."
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c4361578",
   "metadata": {
    "papermill": {
     "duration": 0.01845,
     "end_time": "2024-08-23T13:44:10.179394",
     "exception": false,
     "start_time": "2024-08-23T13:44:10.160944",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "### **Now on to visualising the data and answering the specifc questions**\n",
    "\n",
    "- What are the total sales over the past year?\n",
    "- Which product has the highest sales?\n",
    "- What is the average order value?\n",
    "- How many unique customers made purchases?\n",
    "- What is the sales trend over the past year?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "8047fc3f",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:10.218190Z",
     "iopub.status.busy": "2024-08-23T13:44:10.217715Z",
     "iopub.status.idle": "2024-08-23T13:44:10.227816Z",
     "shell.execute_reply": "2024-08-23T13:44:10.226569Z"
    },
    "papermill": {
     "duration": 0.032366,
     "end_time": "2024-08-23T13:44:10.230349",
     "exception": false,
     "start_time": "2024-08-23T13:44:10.197983",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([2003, 2004, 2005])"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# What are the total sales over the past year?\n",
    "# Checking the years present in the year column\n",
    "cleaned_sales_data.YEAR_ID.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "1a1faf98",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:10.268614Z",
     "iopub.status.busy": "2024-08-23T13:44:10.268118Z",
     "iopub.status.idle": "2024-08-23T13:44:10.278470Z",
     "shell.execute_reply": "2024-08-23T13:44:10.277077Z"
    },
    "papermill": {
     "duration": 0.032593,
     "end_time": "2024-08-23T13:44:10.281176",
     "exception": false,
     "start_time": "2024-08-23T13:44:10.248583",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1791486.71"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Locates the Year ID column and indexes the Year 2005 - so we can only see the sales for this year.\n",
    "sales_2005 = cleaned_sales_data.loc[sales_data['YEAR_ID'] == 2005]\n",
    "sales_2005\n",
    "\n",
    "# We calculate the sum of the sales column - for the specific year 2005\n",
    "total_sales3 = sales_2005['SALES'].sum()\n",
    "total_sales3"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "41dcce86",
   "metadata": {
    "papermill": {
     "duration": 0.017982,
     "end_time": "2024-08-23T13:44:10.317579",
     "exception": false,
     "start_time": "2024-08-23T13:44:10.299597",
     "status": "completed"
    },
    "tags": []
   },
   "source": [
    "- I checked the total sales for the whole year and they was all equal \n",
    "- Does not give us much information\n",
    "- So going to go further and check another catergory"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "83ffec99",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:10.356926Z",
     "iopub.status.busy": "2024-08-23T13:44:10.356438Z",
     "iopub.status.idle": "2024-08-23T13:44:10.364826Z",
     "shell.execute_reply": "2024-08-23T13:44:10.363618Z"
    },
    "papermill": {
     "duration": 0.031412,
     "end_time": "2024-08-23T13:44:10.367422",
     "exception": false,
     "start_time": "2024-08-23T13:44:10.336010",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Unnamed: 0', 'ORDERNUMBER', 'QUANTITYORDERED', 'PRICEEACH',\n",
       "       'ORDERLINENUMBER', 'SALES', 'ORDERDATE', 'STATUS', 'QTR_ID', 'MONTH_ID',\n",
       "       'YEAR_ID', 'PRODUCTLINE', 'MSRP', 'PRODUCTCODE', 'CUSTOMERNAME',\n",
       "       'PHONE', 'ADDRESSLINE1', 'CITY', 'STATE', 'POSTALCODE', 'COUNTRY',\n",
       "       'TERRITORY', 'CONTACTLASTNAME', 'CONTACTFIRSTNAME', 'DEALSIZE'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cleaned_sales_data.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "3ee658d6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:10.406975Z",
     "iopub.status.busy": "2024-08-23T13:44:10.406516Z",
     "iopub.status.idle": "2024-08-23T13:44:10.415223Z",
     "shell.execute_reply": "2024-08-23T13:44:10.413867Z"
    },
    "papermill": {
     "duration": 0.031397,
     "end_time": "2024-08-23T13:44:10.417758",
     "exception": false,
     "start_time": "2024-08-23T13:44:10.386361",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['Motorcycles', 'Classic Cars', 'Trucks and Buses', 'Vintage Cars',\n",
       "       'Planes', 'Ships', 'Trains'], dtype=object)"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Goinig to choose the sales by productline - Shows all the products\n",
    "cleaned_sales_data.PRODUCTLINE.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "56a199fc",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-08-23T13:44:10.457276Z",
     "iopub.status.busy": "2024-08-23T13:44:10.456799Z",
     "iopub.status.idle": "2024-08-23T13:44:10.470456Z",
     "shell.execute_reply": "2024-08-23T13:44:10.469251Z"
    },
    "papermill": {
     "duration": 0.036894,
     "end_time": "2024-08-23T13:44:10.473524",
     "exception": false,
     "start_time": "2024-08-23T13:44:10.436630",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# This code groups all the sal\n",
    "product_sales = pd.DataFrame(sales_data.groupby('PRODUCTLINE')['SALES'].sum()).reset_index()\n",
    "product_sales_sorted = product_sales.sort_values(by='SALES')"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 5579601,
     "sourceId": 9225585,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30761,
   "isGpuEnabled": false,
   "isInternetEnabled": false,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 8.502212,
   "end_time": "2024-08-23T13:44:11.114198",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-08-23T13:44:02.611986",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
